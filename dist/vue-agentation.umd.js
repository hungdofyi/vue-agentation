(function(f,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(f=typeof globalThis<"u"?globalThis:f||self,e(f.VueAgentation={},f.Vue))})(this,(function(f,e){"use strict";const we=["aria-label"],Ce={class:"agentation-popup__header"},Ee={class:"agentation-popup__header-content"},Se={class:"agentation-popup__header-title"},_e={key:0,class:"agentation-popup__header-selected"},Ae={class:"agentation-popup__body"},Ne={key:0,style:{"margin-top":"0.5rem"}},Ve={key:0,class:"agentation-popup__styles-pre"},Be={class:"agentation-popup__footer"},Te={class:"agentation-popup__actions"},ne=e.defineComponent({__name:"AnnotationPopup",props:{element:{},x:{},y:{},selectedText:{},initialValue:{default:""},submitLabel:{default:"Add"},accentColor:{default:"#3b82f6"},dark:{type:Boolean,default:!1},computedStyles:{}},emits:["submit","cancel"],setup(t,{expose:n,emit:o}){const i=o,l=e.ref(t.initialValue),s=e.ref(null),g=e.ref(!1),x=e.ref(!1),y=e.ref("initial"),N=e.computed(()=>{let m=t.x,$=t.y+20;return typeof window<"u"&&(m+320>window.innerWidth-16&&(m=window.innerWidth-320-16),m<16&&(m=16),$+200>window.innerHeight-16&&($=t.y-200-10),$<16&&($=16)),{left:`${m}px`,top:`${$}px`}});function A(){const c=l.value.trim();if(!c){b();return}i("submit",c)}function S(){y.value="exit",setTimeout(()=>{i("cancel")},150)}function b(){g.value=!0,setTimeout(()=>{g.value=!1},500)}function C(c){c.key==="Enter"&&(c.metaKey||c.ctrlKey)?(c.preventDefault(),A()):c.key==="Escape"&&(c.preventDefault(),S())}e.onMounted(()=>{y.value="enter",e.nextTick(()=>{var c;y.value="entered",(c=s.value)==null||c.focus()})});function h(c){c.key==="Escape"&&S()}return e.onMounted(()=>{document.addEventListener("keydown",h)}),e.onUnmounted(()=>{document.removeEventListener("keydown",h)}),n({shake:b}),(c,r)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["agentation-popup",[t.dark?"agentation-popup--dark":"",g.value&&"agentation-animate-shake",y.value==="initial"&&"agentation-popup--entering",y.value==="enter"&&"agentation-popup--entering",y.value==="entered"&&"agentation-popup--entered",y.value==="exit"&&"agentation-popup--exiting"]]),style:e.normalizeStyle(N.value),"data-agentation-ignore":"",role:"dialog","aria-modal":"true","aria-label":`Add annotation for ${t.element}`},[e.createElementVNode("div",Ce,[e.createElementVNode("div",Ee,[e.createElementVNode("div",{class:"agentation-popup__header-dot",style:e.normalizeStyle({backgroundColor:t.accentColor})},null,4),e.createElementVNode("span",Se,e.toDisplayString(t.element),1)]),t.selectedText?(e.openBlock(),e.createElementBlock("p",_e,' "'+e.toDisplayString(t.selectedText)+'" ',1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",Ae,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"textareaRef",ref:s,"onUpdate:modelValue":r[0]||(r[0]=k=>l.value=k),class:"agentation-popup__textarea",placeholder:"Add your comment...",onKeydown:C},null,544),[[e.vModelText,l.value]]),t.computedStyles?(e.openBlock(),e.createElementBlock("div",Ne,[e.createElementVNode("button",{type:"button",class:"agentation-popup__styles-toggle",onClick:r[1]||(r[1]=k=>x.value=!x.value)},[(e.openBlock(),e.createElementBlock("svg",{class:e.normalizeClass(["agentation-popup__styles-icon",x.value&&"agentation-popup__styles-icon--open"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[2]||(r[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2)),r[3]||(r[3]=e.createTextVNode(" Computed styles ",-1))]),x.value?(e.openBlock(),e.createElementBlock("pre",Ve,e.toDisplayString(t.computedStyles),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Be,[r[4]||(r[4]=e.createElementVNode("span",{class:"agentation-popup__shortcut"},[e.createElementVNode("kbd",{class:"agentation-popup__kbd"},"⌘"),e.createTextVNode(" + "),e.createElementVNode("kbd",{class:"agentation-popup__kbd"},"Enter"),e.createTextVNode(" to submit ")],-1)),e.createElementVNode("div",Te,[e.createElementVNode("button",{type:"button",class:"agentation-popup__btn agentation-popup__btn--cancel",onClick:S}," Cancel "),e.createElementVNode("button",{type:"button",class:"agentation-popup__btn agentation-popup__btn--submit",style:e.normalizeStyle({backgroundColor:t.accentColor}),onClick:A},e.toDisplayString(t.submitLabel),5)])])],14,we))}}),ve={class:"agentation-marker__tooltip-header"},Le={class:"agentation-marker__tooltip-content"},Pe={class:"agentation-marker__tooltip-title"},Me={class:"agentation-marker__tooltip-path"},Ie={class:"agentation-marker__tooltip-actions"},ze={class:"agentation-marker__tooltip-body"},De={class:"agentation-marker__tooltip-comment"},Fe={key:0,class:"agentation-marker__tooltip-selected-text"},je={class:"agentation-marker__tooltip-footer"},Z=((t,n)=>{const o=t.__vccOpts||t;for(const[i,l]of n)o[i]=l;return o})(e.defineComponent({__name:"AnnotationMarker",props:{annotation:{},index:{},dark:{type:Boolean,default:!1},accentColor:{default:"#3b82f6"},isHovered:{type:Boolean,default:!1}},emits:["click","delete","edit","mouseenter","mouseleave"],setup(t,{emit:n}){const o=n,i=e.ref(!1),l=e.ref("initial"),s=e.computed(()=>{const b={left:`${t.annotation.x}%`};return t.annotation.isFixed?b.top=`${t.annotation.y}px`:b.top=`${t.annotation.y}px`,b}),g=e.computed(()=>t.annotation.x>70?"left":"right");function x(b){b.stopPropagation(),o("click",t.annotation)}function y(b){b.stopPropagation(),l.value="exit",setTimeout(()=>{o("delete",t.annotation)},200)}function N(b){b.stopPropagation(),o("edit",t.annotation)}function A(){i.value=!0,o("mouseenter",t.annotation)}function S(){i.value=!1,o("mouseleave",t.annotation)}return e.onMounted(()=>{l.value="enter",requestAnimationFrame(()=>{requestAnimationFrame(()=>{l.value="entered"})})}),(b,C)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["agentation-marker",[t.annotation.isFixed?"agentation-marker--fixed":"agentation-marker--absolute",l.value==="initial"&&"agentation-marker--entering",l.value==="enter"&&"agentation-marker--entering",l.value==="entered"&&"agentation-marker--entered",l.value==="exit"&&"agentation-marker--exiting"]]),style:e.normalizeStyle(s.value),"data-agentation-ignore":"",onMouseenter:A,onMouseleave:S,onClick:x},[e.createElementVNode("div",{class:e.normalizeClass(["agentation-marker__dot",[t.isHovered&&"agentation-marker__dot--hovered"]]),style:e.normalizeStyle({backgroundColor:t.accentColor})},[e.createTextVNode(e.toDisplayString(t.index+1)+" ",1),e.createElementVNode("div",{class:"agentation-marker__ping agentation-animate-ping",style:e.normalizeStyle({backgroundColor:t.accentColor})},null,4)],6),e.createVNode(e.Transition,{"enter-active-class":"agentation-transition-enter-active","enter-from-class":"agentation-transition-enter","enter-to-class":"agentation-transition-enter-to","leave-active-class":"agentation-transition-leave-active","leave-from-class":"agentation-transition-leave","leave-to-class":"agentation-transition-leave-to"},{default:e.withCtx(()=>[i.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["agentation-marker__tooltip",[t.dark?"agentation-marker__tooltip--dark":"",g.value==="left"?"agentation-marker__tooltip--left":"agentation-marker__tooltip--right"]]),onClick:C[0]||(C[0]=e.withModifiers(()=>{},["stop"]))},[e.createElementVNode("div",ve,[e.createElementVNode("div",Le,[e.createElementVNode("span",Pe,e.toDisplayString(t.annotation.element),1),e.createElementVNode("p",Me,e.toDisplayString(t.annotation.elementPath),1)]),e.createElementVNode("div",Ie,[e.createElementVNode("button",{type:"button",class:"agentation-marker__tooltip-action",title:"Edit annotation",onClick:e.withModifiers(N,["stop"])},[...C[1]||(C[1]=[e.createElementVNode("svg",{class:"agentation-marker__tooltip-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])]),e.createElementVNode("button",{type:"button",class:"agentation-marker__tooltip-action",title:"Delete annotation",onClick:y},[...C[2]||(C[2]=[e.createElementVNode("svg",{class:"agentation-marker__tooltip-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])]),e.createElementVNode("div",ze,[e.createElementVNode("p",De,e.toDisplayString(t.annotation.comment),1),t.annotation.selectedText?(e.openBlock(),e.createElementBlock("p",Fe,' "'+e.toDisplayString(t.annotation.selectedText)+'" ',1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",je,e.toDisplayString(new Date(t.annotation.timestamp).toLocaleString()),1)],2)):e.createCommentVNode("",!0)]),_:1})],38))}}),[["__scopeId","data-v-8b7a5f10"]]),qe="agentation-annotations-",oe="agentation-settings",He=7;function j(t){return`${qe}${t}`}function q(){if(typeof window>"u")return"/";const t=window.location.hash;return t&&t.startsWith("#/")?t.slice(1):window.location.pathname}function J(t){if(typeof window>"u")return[];try{const n=localStorage.getItem(j(t));if(!n)return[];const o=JSON.parse(n),i=Date.now()-He*24*60*60*1e3;return o.filter(l=>!l.timestamp||l.timestamp>i)}catch{return[]}}function H(t,n){if(!(typeof window>"u"))try{localStorage.setItem(j(t),JSON.stringify(n))}catch{}}function ie(t){if(!(typeof window>"u"))try{localStorage.removeItem(j(t))}catch{}}function Oe(){if(typeof window>"u")return null;try{const t=localStorage.getItem(oe);return t?JSON.parse(t):null}catch{return null}}function Re(t){if(!(typeof window>"u"))try{localStorage.setItem(oe,JSON.stringify(t))}catch{}}function ae(){if(typeof window>"u")return null;try{const t=localStorage.getItem("agentation-theme");return t==="light"||t==="dark"?t:null}catch{return null}}function X(t){if(!(typeof window>"u"))try{localStorage.setItem("agentation-theme",t)}catch{}}let O=null;function We(){const t=e.ref([]),n=e.ref(null),o=e.ref(null),i=e.ref("");function l(r){i.value=r,t.value=J(r)}function s(r){i.value=r,t.value=J(r),n.value=null,o.value=null}function g(r,k){const m={id:crypto.randomUUID(),x:r.x,y:r.y,comment:k,element:r.element,elementPath:r.elementPath,timestamp:Date.now(),selectedText:r.selectedText,boundingBox:r.boundingBox,nearbyText:r.nearbyText,cssClasses:r.cssClasses,nearbyElements:r.nearbyElements,computedStyles:r.computedStyles,fullPath:r.fullPath,accessibility:r.accessibility,isFixed:r.isFixed};return t.value=[...t.value,m],H(i.value,t.value),n.value=null,m}function x(r){const k=t.value.find(m=>m.id===r);return k?(t.value=t.value.filter(m=>m.id!==r),H(i.value,t.value),k):null}function y(r,k){const m=t.value.findIndex(V=>V.id===r);if(m===-1)return null;const $={...t.value[m],comment:k};return t.value=[...t.value.slice(0,m),$,...t.value.slice(m+1)],H(i.value,t.value),o.value=null,$}function N(){t.value=[],ie(i.value)}function A(r){n.value=r}function S(r){o.value=r}function b(r){return t.value.find(k=>k.id===r)}function C(r){return t.value.findIndex(k=>k.id===r)}const h=e.computed(()=>t.value.length),c=e.computed(()=>t.value.length===0);return{annotations:e.readonly(t),pendingAnnotation:e.readonly(n),editingAnnotationId:e.readonly(o),count:h,isEmpty:c,initialize:l,switchPath:s,add:g,remove:x,update:y,clear:N,setPending:A,setEditing:S,getById:b,getIndex:C}}function le(){return O||(O=We()),O}function Ue(){O=null}function re(t,n=3){const o=[];let i=t,l=0;for(;i&&i!==document.body&&l<n;){let s=i.tagName.toLowerCase();if(i.id)s+=`#${i.id}`;else if(i.classList.length>0){const g=Array.from(i.classList).find(x=>!x.match(/^_/)&&!x.match(/[A-Za-z]+_[a-z0-9]{5,}/));g&&(s+=`.${g}`)}o.unshift(s),i=i.parentElement,l++}return o.join(" > ")}function se(t){const n=[];let o=t;for(;o&&o!==document.documentElement;){let i=o.tagName.toLowerCase();if(o.id)i+=`#${o.id}`;else{const l=o.parentElement;if(l){const s=Array.from(l.children).filter(g=>g.tagName===o.tagName);if(s.length>1){const g=s.indexOf(o)+1;i+=`:nth-of-type(${g})`}}}n.unshift(i),o=o.parentElement}return n.join(" > ")}function Q(t){var i,l,s,g,x,y,N,A,S,b,C,h,c,r,k,m,$,V,_,B,P,W,U,T,Y,M;const n=re(t),o=t.tagName.toLowerCase();if(t instanceof SVGElement||t.closest("svg")){const a=t.closest("svg"),p=(i=a==null?void 0:a.querySelector("title"))==null?void 0:i.textContent,E=a==null?void 0:a.getAttribute("aria-label");return{name:p||E||"SVG graphic",path:n}}if(o==="button"||t.getAttribute("role")==="button")return{name:`Button: "${((l=t.textContent)==null?void 0:l.trim().slice(0,30))||t.getAttribute("aria-label")||"Button"}"`,path:n};if(o==="a")return{name:`Link: "${((s=t.textContent)==null?void 0:s.trim().slice(0,30))||t.getAttribute("aria-label")||"Link"}"`,path:n};if(o==="input"||o==="textarea"||o==="select"){if(t.id)return{name:`${o}#${t.id}`,path:n};if(t.classList.length>0){const D=Array.from(t.classList).filter(I=>!(I.match(/^_[a-zA-Z0-9]+$/)||I.match(/[A-Za-z]+_[a-z0-9]{5,}$/)));if(D.length>0){const I=D.slice(0,2).join(".");return{name:`${o}.${I}`,path:n}}}const a=t.id?document.querySelector(`label[for="${t.id}"]`):null,p=(g=a==null?void 0:a.textContent)==null?void 0:g.trim(),E=t.getAttribute("aria-label"),K=t.getAttribute("placeholder"),z=t.getAttribute("name"),L=o==="select"?"select":o==="textarea"?"textarea":t.type||"text",G=p||E||K||z;return G?{name:`${o}[${L}]: "${G.slice(0,30)}"`,path:n}:{name:o==="input"?`${o}[${L}]`:o,path:n}}if(/^h[1-6]$/.test(o)){const a=(x=t.textContent)==null?void 0:x.trim().slice(0,40);return{name:a?`${o}: "${a}"`:o,path:n}}if(o==="p"){const a=(y=t.textContent)==null?void 0:y.trim();return a&&a.length>0?{name:`Paragraph: "${a.slice(0,40)+(a.length>40?"...":"")}"`,path:n}:{name:"Paragraph",path:n}}if(o==="img"){const a=t.alt;return{name:a?`Image: "${a}"`:"Image",path:n}}if(o==="label"){const a=t.getAttribute("for"),p=(N=t.textContent)==null?void 0:N.trim().slice(0,30);return a?{name:`Label[for="${a}"]: "${p||""}"`,path:n}:{name:p?`Label: "${p}"`:"Label",path:n}}if(o==="table"){const a=(S=(A=t.querySelector("caption"))==null?void 0:A.textContent)==null?void 0:S.trim().slice(0,30),p=t.getAttribute("aria-label");return{name:a||p?`Table: "${a||p}"`:"Table",path:n}}if(o==="thead")return{name:"Table header",path:n};if(o==="tbody")return{name:"Table body",path:n};if(o==="tfoot")return{name:"Table footer",path:n};if(o==="tr"){const a=t.rowIndex;return{name:`Table row ${a>=0?`#${a+1}`:""}`,path:n}}if(o==="th"){const a=(b=t.textContent)==null?void 0:b.trim().slice(0,25);return{name:a?`Table header: "${a}"`:"Table header cell",path:n}}if(o==="td"){const a=(C=t.textContent)==null?void 0:C.trim().slice(0,25);return{name:a?`Table cell: "${a}"`:"Table cell",path:n}}if(o==="form"){const a=t.getAttribute("name")||t.getAttribute("id"),p=t.getAttribute("action");return a?{name:`Form: "${a}"`,path:n}:p?{name:`Form → ${p.slice(0,30)}`,path:n}:{name:"Form",path:n}}if(o==="fieldset"){const a=(c=(h=t.querySelector("legend"))==null?void 0:h.textContent)==null?void 0:c.trim().slice(0,30);return{name:a?`Fieldset: "${a}"`:"Fieldset",path:n}}if(o==="legend"){const a=(r=t.textContent)==null?void 0:r.trim().slice(0,30);return{name:a?`Legend: "${a}"`:"Legend",path:n}}if(o==="video"){const a=t.src||((k=t.querySelector("source"))==null?void 0:k.src);return{name:a?`Video: ${((m=a.split("/").pop())==null?void 0:m.slice(0,25))||"video"}`:"Video",path:n}}if(o==="audio"){const a=t.src||(($=t.querySelector("source"))==null?void 0:$.src);return{name:a?`Audio: ${((V=a.split("/").pop())==null?void 0:V.slice(0,25))||"audio"}`:"Audio",path:n}}if(o==="iframe"){const a=t.getAttribute("title"),p=t.src;if(a)return{name:`Iframe: "${a}"`,path:n};if(p)try{return{name:`Iframe: ${new URL(p).hostname}`,path:n}}catch{return{name:"Iframe",path:n}}return{name:"Iframe",path:n}}if(o==="code"){const a=t.parentElement,p=(a==null?void 0:a.tagName.toLowerCase())==="pre",E=(_=t.textContent)==null?void 0:_.trim().slice(0,30);return{name:p?"Code block":E?`Code: "${E}"`:"Inline code",path:n}}if(o==="pre")return{name:t.querySelector("code")?"Code block":"Preformatted text",path:n};if(o==="dialog"){const a=t.getAttribute("aria-label")||t.getAttribute("aria-labelledby"),E=t.open?" (open)":"";return{name:a?`Dialog: "${a}"${E}`:`Dialog${E}`,path:n}}if(o==="progress"){const a=t.value,p=t.max;return{name:`Progress: ${Math.round(a/p*100)}%`,path:n}}if(o==="meter")return{name:`Meter: ${t.value}`,path:n};if(o==="canvas"){const a=t.getAttribute("aria-label");return{name:a?`Canvas: "${a}"`:"Canvas",path:n}}if(o==="figure"){const a=(P=(B=t.querySelector("figcaption"))==null?void 0:B.textContent)==null?void 0:P.trim().slice(0,30);return{name:a?`Figure: "${a}"`:"Figure",path:n}}if(o==="figcaption"){const a=(W=t.textContent)==null?void 0:W.trim().slice(0,30);return{name:a?`Caption: "${a}"`:"Figure caption",path:n}}if(o==="blockquote"){const a=t.getAttribute("cite"),p=(U=t.textContent)==null?void 0:U.trim().slice(0,30);return a?{name:`Blockquote from ${a}`,path:n}:{name:p?`Blockquote: "${p}..."`:"Blockquote",path:n}}if(o==="ul")return{name:`Unordered list (${t.querySelectorAll(":scope > li").length} items)`,path:n};if(o==="ol"){const a=t.querySelectorAll(":scope > li").length,p=t.start||1;return{name:`Ordered list (${a} items, starts at ${p})`,path:n}}if(o==="li"){const a=(T=t.textContent)==null?void 0:T.trim().slice(0,25);return{name:a?`List item: "${a}"`:"List item",path:n}}if(o==="dl")return{name:"Definition list",path:n};if(o==="dt"){const a=(Y=t.textContent)==null?void 0:Y.trim().slice(0,25);return{name:a?`Term: "${a}"`:"Definition term",path:n}}if(o==="dd"){const a=(M=t.textContent)==null?void 0:M.trim().slice(0,25);return{name:a?`Definition: "${a}"`:"Definition",path:n}}if(t.classList.length>0){const a=Array.from(t.classList).filter(p=>!(p.match(/^_[a-zA-Z0-9]+$/)||p.match(/[A-Za-z]+_[a-z0-9]{5,}$/)));if(a.length>0){const p=a.slice(0,3).join(".");return{name:`${o}.${p}`,path:n}}}if(["nav","header","footer","main","section","article"].includes(o)){const a=t.getAttribute("aria-label");if(a)return{name:`${o}: "${a}"`,path:n}}return{name:o,path:n}}function Ye(t){var i;const n=t.tagName.toLowerCase();if(t instanceof SVGElement||t.closest("svg"))return"icon";if(n==="button"||t.getAttribute("role")==="button")return"button";const o=((i=t.className)==null?void 0:i.toString())||"";return o.includes("spinner")||o.includes("loader")||o.includes("loading")?"spinner":n}function ce(t){var s,g,x;const n=[],o=t.previousElementSibling;if(o){const y=(s=o.textContent)==null?void 0:s.trim();y&&y.length<100&&n.push(`[prev]: ${y.slice(0,50)}`)}const i=(g=t.textContent)==null?void 0:g.trim();i&&i.length<200&&n.push(i.slice(0,80));const l=t.nextElementSibling;if(l){const y=(x=l.textContent)==null?void 0:x.trim();y&&y.length<100&&n.push(`[next]: ${y.slice(0,50)}`)}return n.join(" | ")}function de(t){const n=[],o=t.parentElement;o&&o!==document.body&&n.push(`parent: ${o.tagName.toLowerCase()}`);const i=t.previousElementSibling;i&&n.push(`prev: ${i.tagName.toLowerCase()}`);const l=t.nextElementSibling;l&&n.push(`next: ${l.tagName.toLowerCase()}`);const s=t.children.length;return s>0&&n.push(`children: ${s}`),n.join(", ")}function ue(t){return!t.classList||t.classList.length===0?"":Array.from(t.classList).filter(n=>!(n.match(/^_[a-zA-Z0-9]+$/)||n.match(/[A-Za-z]+_[a-z0-9]{5,}$/))).join(" ")}function me(t){const n=window.getComputedStyle(t),o=t.tagName.toLowerCase(),i=[];return i.push(`display: ${n.display}`),i.push(`position: ${n.position}`),["p","span","h1","h2","h3","h4","h5","h6","a","button"].includes(o)&&(i.push(`font-size: ${n.fontSize}`),i.push(`font-weight: ${n.fontWeight}`),i.push(`color: ${n.color}`),i.push(`line-height: ${n.lineHeight}`)),["div","section","article","main","nav","header","footer"].includes(o)&&(i.push(`width: ${n.width}`),i.push(`height: ${n.height}`),i.push(`padding: ${n.padding}`),i.push(`margin: ${n.margin}`),(n.display==="flex"||n.display==="inline-flex")&&(i.push(`flex-direction: ${n.flexDirection}`),i.push(`justify-content: ${n.justifyContent}`),i.push(`align-items: ${n.alignItems}`),i.push(`gap: ${n.gap}`)),(n.display==="grid"||n.display==="inline-grid")&&(i.push(`grid-template-columns: ${n.gridTemplateColumns}`),i.push(`grid-template-rows: ${n.gridTemplateRows}`),i.push(`gap: ${n.gap}`))),n.backgroundColor!=="rgba(0, 0, 0, 0)"&&i.push(`background-color: ${n.backgroundColor}`),n.borderWidth!=="0px"&&i.push(`border: ${n.border}`),n.borderRadius!=="0px"&&i.push(`border-radius: ${n.borderRadius}`),i.join("; ")}function Ke(t){const n=window.getComputedStyle(t);return["display","position","top","right","bottom","left","width","height","min-width","min-height","max-width","max-height","padding","margin","border","border-radius","background","background-color","color","font-family","font-size","font-weight","line-height","text-align","flex-direction","justify-content","align-items","gap","grid-template-columns","grid-template-rows","overflow","z-index","opacity","transform","transition","animation"].map(i=>{const l=n.getPropertyValue(i);return l&&l!=="none"&&l!=="normal"&&l!=="auto"?`${i}: ${l}`:null}).filter(Boolean).join("; ")}function fe(t){const n=[],o=t.getAttribute("role");o&&n.push(`role="${o}"`);const i=Array.from(t.attributes).filter(g=>g.name.startsWith("aria-")).map(g=>`${g.name}="${g.value}"`).join(" ");i&&n.push(i);const l=t.getAttribute("tabindex");return l!==null&&n.push(`tabindex="${l}"`),["a","button","input","textarea","select"].includes(t.tagName.toLowerCase())&&n.push("focusable"),n.join(" ")}function pe(t){let n=t;for(;n&&n!==document.body;){const o=window.getComputedStyle(n).position;if(o==="fixed"||o==="sticky")return!0;n=n.parentElement}return!1}function ge(t){const n=e.ref(!1),o=e.ref(null),i=e.ref(null),l=e.ref(null),s=e.ref(null),g="[data-agentation-ignore]";function x(h){return!!(h.closest(g)||h===document.body||h===document.documentElement)}function y(h){var r,k;const c=h.target;if(s.value={x:h.clientX,y:h.clientY},x(c)){o.value=null,i.value=null,l.value=null,(r=t.onHoverChange)==null||r.call(t,null);return}if(c!==o.value){o.value=c;const m=c.getBoundingClientRect();i.value=m;const{name:$,path:V}=Q(c),_={element:c,name:$,path:V,rect:m};l.value=_,(k=t.onHoverChange)==null||k.call(t,_)}}function N(h){h.preventDefault(),h.stopPropagation();const c=h.target;if(x(c))return;const{name:r,path:k}=Q(c),m=c.getBoundingClientRect(),$=window.innerWidth,V=window.scrollY,_=pe(c),B={x:(m.left+m.width/2)/$*100,y:_?m.top+m.height/2:m.top+m.height/2+V,element:r,elementPath:k,boundingBox:{x:m.left,y:m.top,width:m.width,height:m.height},nearbyText:ce(c),nearbyElements:de(c),cssClasses:ue(c),computedStyles:me(c),fullPath:se(c),accessibility:fe(c),isFixed:_};b(),t.onSelect(B,c)}function A(h){h.key==="Escape"&&b()}function S(){n.value||(n.value=!0,document.addEventListener("mousemove",y,{capture:!0}),document.addEventListener("click",N,{capture:!0}),document.addEventListener("keydown",A),document.body.style.cursor="crosshair")}function b(){var h;n.value&&(n.value=!1,o.value=null,i.value=null,l.value=null,s.value=null,document.removeEventListener("mousemove",y,{capture:!0}),document.removeEventListener("click",N,{capture:!0}),document.removeEventListener("keydown",A),document.body.style.cursor="",(h=t.onHoverChange)==null||h.call(t,null))}function C(){n.value?b():S()}return e.onUnmounted(()=>{n.value&&b()}),{isActive:e.readonly(n),hoveredElement:e.readonly(o),highlightBox:e.readonly(i),elementInfo:e.readonly(l),cursorPosition:e.readonly(s),start:S,stop:b,toggle:C}}const Ge="agentation-animation-freeze",ee="--agentation-animation-state";function he(){const t=e.ref(!1);let n=null;function o(){t.value||(document.documentElement.style.setProperty(ee,"paused"),n||(n=document.createElement("style"),n.id=Ge,n.textContent=`
        *,
        *::before,
        *::after {
          animation-play-state: var(${ee}, running) !important;
        }
      `,document.head.appendChild(n)),document.querySelectorAll("video").forEach(s=>{s.paused||(s.dataset.agentationWasPlaying="true",s.pause())}),t.value=!0)}function i(){t.value&&(document.documentElement.style.removeProperty(ee),n&&n.parentNode&&(n.parentNode.removeChild(n),n=null),document.querySelectorAll("video[data-agentation-was-playing]").forEach(s=>{delete s.dataset.agentationWasPlaying,s.play().catch(()=>{})}),t.value=!1)}function l(){t.value?i():o()}return e.onUnmounted(()=>{t.value&&i()}),{isPaused:e.readonly(t),pause:o,resume:i,toggle:l}}function ye(){const t=e.ref(!1);function n(){const l=ae();l?t.value=l==="dark":typeof window<"u"&&(t.value=window.matchMedia("(prefers-color-scheme: dark)").matches)}function o(){t.value=!t.value,X(t.value?"dark":"light")}function i(l){t.value=l,X(l?"dark":"light")}return e.onMounted(()=>{n()}),{isDark:e.readonly(t),toggle:o,set:i,initialize:n}}function be(t,n="standard"){if(t.length===0)return"No annotations to display.";const o=["# Page Annotations","",`Generated: ${new Date().toISOString()}`,`URL: ${typeof window<"u"?window.location.href:"N/A"}`,"","---",""];return t.forEach((i,l)=>{if(o.push(`## ${l+1}. ${i.element}`),o.push(""),o.push(`**Comment:** ${i.comment}`),o.push(""),o.push(`**Selector:** \`${i.elementPath}\``),o.push(""),o.push(`**Position:** x=${i.x.toFixed(1)}%, y=${i.y.toFixed(0)}px`),o.push(""),i.selectedText&&(o.push(`**Selected Text:** "${i.selectedText}"`),o.push("")),i.boundingBox){const s=i.boundingBox;o.push(`**Bounding Box:** x=${s.x.toFixed(0)}, y=${s.y.toFixed(0)}, w=${s.width.toFixed(0)}, h=${s.height.toFixed(0)}`),o.push("")}n!=="compact"&&(i.nearbyText&&(o.push(`**Nearby Text:** ${i.nearbyText}`),o.push("")),i.cssClasses&&(o.push(`**CSS Classes:** \`${i.cssClasses}\``),o.push(""))),(n==="detailed"||n==="forensic")&&(i.nearbyElements&&(o.push(`**Nearby Elements:** ${i.nearbyElements}`),o.push("")),i.accessibility&&(o.push(`**Accessibility:** ${i.accessibility}`),o.push(""))),n==="forensic"&&(i.fullPath&&(o.push(`**Full Path:** \`${i.fullPath}\``),o.push("")),i.computedStyles&&(o.push("**Computed Styles:**"),o.push("```css"),o.push(i.computedStyles),o.push("```"),o.push(""))),o.push("---"),o.push("")}),o.join(`
`)}function Ze(t){return[`[${t.element}]`,t.comment,`(${t.elementPath})`].join(" ")}const Je=["aria-pressed"],Xe=["aria-pressed","title"],Qe={key:0,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},et={key:1,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},tt=["disabled","title"],nt={key:0,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ot={key:1,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},it={key:2,class:"agentation-toolbar__badge"},at=["disabled"],lt=["title"],rt={key:0,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},st={key:1,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ct={style:{position:"absolute",inset:"0","z-index":"99998","pointer-events":"none"},"data-agentation-ignore":""},te="#3b82f6",R=4,dt=e.defineComponent({__name:"Agentation",emits:["annotation-add","annotation-delete","annotation-update","annotations-clear","copy"],setup(t,{emit:n}){const o=n,{annotations:i,pendingAnnotation:l,editingAnnotationId:s,count:g,isEmpty:x,initialize:y,switchPath:N,add:A,remove:S,update:b,clear:C,setPending:h,setEditing:c,getById:r}=le(),{isPaused:k,toggle:m}=he(),{isDark:$,toggle:V}=ye(),_=e.ref(!1),B=e.ref(null),P=e.ref(!1),W=e.computed(()=>{if(l.value)return l.value.x/100*(typeof window<"u"?window.innerWidth:0);if(s.value){const u=r(s.value);return u?u.x/100*(typeof window<"u"?window.innerWidth:0):0}return 0}),U=e.computed(()=>{if(l.value){const u=typeof window<"u"?window.scrollY:0;return l.value.isFixed?l.value.y:l.value.y-u}else if(s.value){const u=r(s.value);if(!u)return 0;const d=typeof window<"u"?window.scrollY:0;return u.isFixed?u.y:u.y-d}return 0}),T=e.computed(()=>{if(l.value)return{element:l.value.element,selectedText:l.value.selectedText,computedStyles:l.value.computedStyles,initialValue:"",submitLabel:"Add"};if(s.value){const u=r(s.value);if(u)return{element:u.element,selectedText:u.selectedText,computedStyles:u.computedStyles,initialValue:u.comment,submitLabel:"Update"}}return null}),Y=e.computed(()=>{if(!E.value)return{};const u=typeof window<"u"?window.innerWidth:1e3,d=150,w=32;let v=E.value.x+R,F=E.value.y-w-R;return v+d>u&&(v=E.value.x-d-R),F<0&&(F=E.value.y+R),{left:`${v}px`,top:`${F}px`}}),{isActive:M,highlightBox:a,elementInfo:p,cursorPosition:E,toggle:K}=ge({onSelect:u=>{h(u),c(null),_.value=!0},onHoverChange:()=>{}}),z=e.ref(q());let L=null;function G(){const u=q();u!==z.value&&(z.value=u,N(u))}function D(){G(),L=requestAnimationFrame(D)}e.onMounted(()=>{if(typeof window<"u"){const u=q();z.value=u,y(u),L=requestAnimationFrame(D)}}),e.onUnmounted(()=>{L!==null&&(cancelAnimationFrame(L),L=null)});function I(u){if(l.value){const d=A(l.value,u);_.value=!1,o("annotation-add",d)}else if(s.value){const d=b(s.value,u);_.value=!1,c(null),d&&o("annotation-update",d)}}function ut(){_.value=!1,h(null),c(null)}function ke(u){const d=S(u.id);d&&o("annotation-delete",d)}function xe(u){h(null),c(u.id),_.value=!0}function mt(){i.value.length!==0&&confirm("Clear all annotations?")&&(C(),o("annotations-clear"))}async function ft(){const u=be([...i.value]);try{await navigator.clipboard.writeText(u),P.value=!0,setTimeout(()=>{P.value=!1},2e3)}catch{console.log(u)}o("copy",u)}function $e(u){console.log("Marker clicked:",u)}return(u,d)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{class:e.normalizeClass(["agentation-toolbar",e.unref($)?"agentation-toolbar--dark":""]),"data-agentation-ignore":"",role:"toolbar","aria-label":"Agentation annotation tools"},[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",e.unref(M)&&"agentation-toolbar__button--active"]),"aria-pressed":e.unref(M),title:"Select element to annotate",onClick:d[0]||(d[0]=(...w)=>e.unref(K)&&e.unref(K)(...w))},[...d[5]||(d[5]=[e.createElementVNode("svg",{class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{d:"M4 4l7.07 17 2.51-7.39L21 11.07 4 4zm9.33 8.33l-1.62 4.79L6.27 6.27l10.85 5.06-3.79 1z"})],-1)])],10,Je),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",e.unref(k)&&"agentation-toolbar__button--paused"]),"aria-pressed":e.unref(k),title:e.unref(k)?"Resume animations":"Pause animations",onClick:d[1]||(d[1]=(...w)=>e.unref(m)&&e.unref(m)(...w))},[e.unref(k)?(e.openBlock(),e.createElementBlock("svg",Qe,[...d[6]||(d[6]=[e.createElementVNode("path",{d:"M8 5v14l11-7z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",et,[...d[7]||(d[7]=[e.createElementVNode("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"},null,-1)])]))],10,Xe),d[13]||(d[13]=e.createElementVNode("div",{class:"agentation-toolbar__divider"},null,-1)),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",P.value&&"agentation-toolbar__button--success"]),disabled:e.unref(x),title:`Copy ${e.unref(g)} annotation(s) as markdown`,onClick:ft},[P.value?(e.openBlock(),e.createElementBlock("svg",nt,[...d[8]||(d[8]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",ot,[...d[9]||(d[9]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])),e.unref(g)>0?(e.openBlock(),e.createElementBlock("span",it,e.toDisplayString(e.unref(g)),1)):e.createCommentVNode("",!0)],10,tt),e.createElementVNode("button",{type:"button",class:"agentation-toolbar__button",disabled:e.unref(x),title:"Clear all annotations",onClick:mt},[...d[10]||(d[10]=[e.createElementVNode("svg",{class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,at),d[14]||(d[14]=e.createElementVNode("div",{class:"agentation-toolbar__divider"},null,-1)),e.createElementVNode("button",{type:"button",class:"agentation-toolbar__button",title:e.unref($)?"Switch to light mode":"Switch to dark mode",onClick:d[2]||(d[2]=(...w)=>e.unref(V)&&e.unref(V)(...w))},[e.unref($)?(e.openBlock(),e.createElementBlock("svg",rt,[...d[11]||(d[11]=[e.createElementVNode("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",st,[...d[12]||(d[12]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])]))],8,lt)],2),e.unref(M)&&e.unref(a)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"agentation-highlight",style:e.normalizeStyle({left:`${e.unref(a).left}px`,top:`${e.unref(a).top}px`,width:`${e.unref(a).width}px`,height:`${e.unref(a).height}px`}),"data-agentation-ignore":""},null,4)):e.createCommentVNode("",!0),e.unref(M)&&e.unref(p)&&e.unref(E)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"agentation-highlight__tooltip",style:e.normalizeStyle(Y.value),"data-agentation-ignore":""},e.toDisplayString(e.unref(p).name),5)):e.createCommentVNode("",!0),e.createElementVNode("div",ct,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).filter(w=>!w.isFixed),(w,v)=>(e.openBlock(),e.createBlock(Z,{key:w.id,annotation:w,index:v,dark:e.unref($),"accent-color":te,"is-hovered":B.value===w.id,style:{"pointer-events":"auto"},onClick:$e,onEdit:xe,onDelete:ke,onMouseenter:F=>B.value=w.id,onMouseleave:d[3]||(d[3]=F=>B.value=null)},null,8,["annotation","index","dark","is-hovered","onMouseenter"]))),128))]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).filter(w=>w.isFixed),w=>(e.openBlock(),e.createBlock(Z,{key:w.id,annotation:w,index:e.unref(i).findIndex(v=>v.id===w.id),dark:e.unref($),"accent-color":te,"is-hovered":B.value===w.id,onClick:$e,onEdit:xe,onDelete:ke,onMouseenter:v=>B.value=w.id,onMouseleave:d[4]||(d[4]=v=>B.value=null)},null,8,["annotation","index","dark","is-hovered","onMouseenter"]))),128)),_.value&&T.value?(e.openBlock(),e.createBlock(ne,{key:2,element:T.value.element,x:W.value,y:U.value,"selected-text":T.value.selectedText,"computed-styles":T.value.computedStyles,"initial-value":T.value.initialValue,"submit-label":T.value.submitLabel,dark:e.unref($),"accent-color":te,onSubmit:I,onCancel:ut},null,8,["element","x","y","selected-text","computed-styles","initial-value","submit-label","dark"])):e.createCommentVNode("",!0)]))}});f.Agentation=dt,f.AnnotationMarker=Z,f.AnnotationPopup=ne,f.clearAnnotations=ie,f.generateAnnotationSummary=Ze,f.generateMarkdown=be,f.getAccessibilityInfo=fe,f.getCurrentRoutePath=q,f.getDetailedComputedStyles=me,f.getElementClasses=ue,f.getElementPath=re,f.getForensicComputedStyles=Ke,f.getFullElementPath=se,f.getNearbyElements=de,f.getNearbyText=ce,f.getStorageKey=j,f.identifyAnimationElement=Ye,f.identifyElement=Q,f.isElementFixed=pe,f.loadAnnotations=J,f.loadSettings=Oe,f.loadTheme=ae,f.resetAnnotations=Ue,f.saveAnnotations=H,f.saveSettings=Re,f.saveTheme=X,f.useAnimationPause=he,f.useAnnotations=le,f.useElementSelection=ge,f.useTheme=ye,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})}));
