(function(u,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(u=typeof globalThis<"u"?globalThis:u||self,e(u.VueAgentation={},u.Vue))})(this,(function(u,e){"use strict";const he=["aria-label"],ye={class:"agentation-popup__header"},ke={class:"agentation-popup__header-content"},be={class:"agentation-popup__header-title"},we={key:0,class:"agentation-popup__header-selected"},Ee={class:"agentation-popup__body"},xe={key:0,style:{"margin-top":"0.5rem"}},Ce={key:0,class:"agentation-popup__styles-pre"},$e={class:"agentation-popup__footer"},_e={class:"agentation-popup__actions"},Y=e.defineComponent({__name:"AnnotationPopup",props:{element:{},x:{},y:{},selectedText:{},initialValue:{default:""},submitLabel:{default:"Add"},accentColor:{default:"#3b82f6"},dark:{type:Boolean,default:!1},computedStyles:{}},emits:["submit","cancel"],setup(t,{expose:n,emit:o}){const a=o,i=e.ref(t.initialValue),r=e.ref(null),f=e.ref(!1),E=e.ref(!1),g=e.ref("initial"),$=e.computed(()=>{let b=t.x,C=t.y+20;return typeof window<"u"&&(b+320>window.innerWidth-16&&(b=window.innerWidth-320-16),b<16&&(b=16),C+200>window.innerHeight-16&&(C=t.y-200-10),C<16&&(C=16)),{left:`${b}px`,top:`${C}px`}});function c(){const p=i.value.trim();if(!p){x();return}a("submit",p)}function k(){g.value="exit",setTimeout(()=>{a("cancel")},150)}function x(){f.value=!0,setTimeout(()=>{f.value=!1},500)}function h(p){p.key==="Enter"&&(p.metaKey||p.ctrlKey)?(p.preventDefault(),c()):p.key==="Escape"&&(p.preventDefault(),k())}e.onMounted(()=>{g.value="enter",e.nextTick(()=>{var p;g.value="entered",(p=r.value)==null||p.focus()})});function y(p){p.key==="Escape"&&k()}return e.onMounted(()=>{document.addEventListener("keydown",y)}),e.onUnmounted(()=>{document.removeEventListener("keydown",y)}),n({shake:x}),(p,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["agentation-popup",[t.dark?"agentation-popup--dark":"",f.value&&"agentation-animate-shake",g.value==="initial"&&"agentation-popup--entering",g.value==="enter"&&"agentation-popup--entering",g.value==="entered"&&"agentation-popup--entered",g.value==="exit"&&"agentation-popup--exiting"]]),style:e.normalizeStyle($.value),"data-agentation-ignore":"",role:"dialog","aria-modal":"true","aria-label":`Add annotation for ${t.element}`},[e.createElementVNode("div",ye,[e.createElementVNode("div",ke,[e.createElementVNode("div",{class:"agentation-popup__header-dot",style:e.normalizeStyle({backgroundColor:t.accentColor})},null,4),e.createElementVNode("span",be,e.toDisplayString(t.element),1)]),t.selectedText?(e.openBlock(),e.createElementBlock("p",we,' "'+e.toDisplayString(t.selectedText)+'" ',1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",Ee,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"textareaRef",ref:r,"onUpdate:modelValue":l[0]||(l[0]=m=>i.value=m),class:"agentation-popup__textarea",placeholder:"Add your comment...",onKeydown:h},null,544),[[e.vModelText,i.value]]),t.computedStyles?(e.openBlock(),e.createElementBlock("div",xe,[e.createElementVNode("button",{type:"button",class:"agentation-popup__styles-toggle",onClick:l[1]||(l[1]=m=>E.value=!E.value)},[(e.openBlock(),e.createElementBlock("svg",{class:e.normalizeClass(["agentation-popup__styles-icon",E.value&&"agentation-popup__styles-icon--open"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...l[2]||(l[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2)),l[3]||(l[3]=e.createTextVNode(" Computed styles ",-1))]),E.value?(e.openBlock(),e.createElementBlock("pre",Ce,e.toDisplayString(t.computedStyles),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createElementVNode("div",$e,[l[4]||(l[4]=e.createElementVNode("span",{class:"agentation-popup__shortcut"},[e.createElementVNode("kbd",{class:"agentation-popup__kbd"},"âŒ˜"),e.createTextVNode(" + "),e.createElementVNode("kbd",{class:"agentation-popup__kbd"},"Enter"),e.createTextVNode(" to submit ")],-1)),e.createElementVNode("div",_e,[e.createElementVNode("button",{type:"button",class:"agentation-popup__btn agentation-popup__btn--cancel",onClick:k}," Cancel "),e.createElementVNode("button",{type:"button",class:"agentation-popup__btn agentation-popup__btn--submit",style:e.normalizeStyle({backgroundColor:t.accentColor}),onClick:c},e.toDisplayString(t.submitLabel),5)])])],14,he))}}),Se={class:"agentation-marker__tooltip-header"},Ne={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Ae={class:"agentation-marker__tooltip-title"},Ve={style:{display:"flex",gap:"0.25rem"}},Be={class:"agentation-marker__tooltip-path"},ve={class:"agentation-marker__tooltip-body"},Te={class:"agentation-marker__tooltip-comment"},Pe={key:0,class:"agentation-marker__tooltip-selected-text"},Le={class:"agentation-marker__tooltip-footer"},I=((t,n)=>{const o=t.__vccOpts||t;for(const[a,i]of n)o[a]=i;return o})(e.defineComponent({__name:"AnnotationMarker",props:{annotation:{},index:{},dark:{type:Boolean,default:!1},accentColor:{default:"#3b82f6"},isHovered:{type:Boolean,default:!1}},emits:["click","delete","edit","mouseenter","mouseleave"],setup(t,{emit:n}){const o=n,a=e.ref(!1),i=e.ref("initial"),r=e.computed(()=>{const x={left:`${t.annotation.x}%`};return t.annotation.isFixed?x.top=`${t.annotation.y}px`:x.top=`${t.annotation.y}px`,x}),f=e.computed(()=>t.annotation.x>70?"left":"right");function E(x){x.stopPropagation(),o("click",t.annotation)}function g(x){x.stopPropagation(),i.value="exit",setTimeout(()=>{o("delete",t.annotation)},200)}function $(x){x.stopPropagation(),o("edit",t.annotation)}function c(){a.value=!0,o("mouseenter",t.annotation)}function k(){a.value=!1,o("mouseleave",t.annotation)}return e.onMounted(()=>{i.value="enter",requestAnimationFrame(()=>{requestAnimationFrame(()=>{i.value="entered"})})}),(x,h)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["agentation-marker",[t.annotation.isFixed?"agentation-marker--fixed":"agentation-marker--absolute",i.value==="initial"&&"agentation-marker--entering",i.value==="enter"&&"agentation-marker--entering",i.value==="entered"&&"agentation-marker--entered",i.value==="exit"&&"agentation-marker--exiting"]]),style:e.normalizeStyle(r.value),"data-agentation-ignore":"",onMouseenter:c,onMouseleave:k,onClick:E},[e.createElementVNode("div",{class:e.normalizeClass(["agentation-marker__dot",[t.isHovered&&"agentation-marker__dot--hovered"]]),style:e.normalizeStyle({backgroundColor:t.accentColor})},[e.createTextVNode(e.toDisplayString(t.index+1)+" ",1),e.createElementVNode("div",{class:"agentation-marker__ping agentation-animate-ping",style:e.normalizeStyle({backgroundColor:t.accentColor})},null,4)],6),e.createVNode(e.Transition,{"enter-active-class":"agentation-transition-enter-active","enter-from-class":"agentation-transition-enter","enter-to-class":"agentation-transition-enter-to","leave-active-class":"agentation-transition-leave-active","leave-from-class":"agentation-transition-leave","leave-to-class":"agentation-transition-leave-to"},{default:e.withCtx(()=>[a.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["agentation-marker__tooltip",[t.dark?"agentation-marker__tooltip--dark":"",f.value==="left"?"agentation-marker__tooltip--left":"agentation-marker__tooltip--right"]]),onClick:h[0]||(h[0]=e.withModifiers(()=>{},["stop"]))},[e.createElementVNode("div",Se,[e.createElementVNode("div",Ne,[e.createElementVNode("span",Ae,e.toDisplayString(t.annotation.element),1),e.createElementVNode("div",Ve,[e.createElementVNode("button",{type:"button",class:"agentation-marker__tooltip-action",title:"Edit annotation",onClick:e.withModifiers($,["stop"])},[...h[1]||(h[1]=[e.createElementVNode("svg",{class:"agentation-marker__tooltip-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])]),e.createElementVNode("button",{type:"button",class:"agentation-marker__tooltip-action",title:"Delete annotation",onClick:g},[...h[2]||(h[2]=[e.createElementVNode("svg",{class:"agentation-marker__tooltip-action-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])]),e.createElementVNode("p",Be,e.toDisplayString(t.annotation.elementPath),1)]),e.createElementVNode("div",ve,[e.createElementVNode("p",Te,e.toDisplayString(t.annotation.comment),1),t.annotation.selectedText?(e.openBlock(),e.createElementBlock("p",Pe,' "'+e.toDisplayString(t.annotation.selectedText)+'" ',1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",Le,e.toDisplayString(new Date(t.annotation.timestamp).toLocaleString()),1)],2)):e.createCommentVNode("",!0)]),_:1})],38))}}),[["__scopeId","data-v-675bf045"]]),Me="agentation-annotations-",q="agentation-settings",ze=7;function T(t){return`${Me}${t}`}function P(){if(typeof window>"u")return"/";const t=window.location.hash;return t&&t.startsWith("#/")?t.slice(1):window.location.pathname}function D(t){if(typeof window>"u")return[];try{const n=localStorage.getItem(T(t));if(!n)return[];const o=JSON.parse(n),a=Date.now()-ze*24*60*60*1e3;return o.filter(i=>!i.timestamp||i.timestamp>a)}catch{return[]}}function L(t,n){if(!(typeof window>"u"))try{localStorage.setItem(T(t),JSON.stringify(n))}catch{}}function G(t){if(!(typeof window>"u"))try{localStorage.removeItem(T(t))}catch{}}function Ie(){if(typeof window>"u")return null;try{const t=localStorage.getItem(q);return t?JSON.parse(t):null}catch{return null}}function De(t){if(!(typeof window>"u"))try{localStorage.setItem(q,JSON.stringify(t))}catch{}}function K(){if(typeof window>"u")return null;try{const t=localStorage.getItem("agentation-theme");return t==="light"||t==="dark"?t:null}catch{return null}}function F(t){if(!(typeof window>"u"))try{localStorage.setItem("agentation-theme",t)}catch{}}let M=null;function Fe(){const t=e.ref([]),n=e.ref(null),o=e.ref(null),a=e.ref("");function i(l){a.value=l,t.value=D(l)}function r(l){a.value=l,t.value=D(l),n.value=null,o.value=null}function f(l,m){const b={id:crypto.randomUUID(),x:l.x,y:l.y,comment:m,element:l.element,elementPath:l.elementPath,timestamp:Date.now(),selectedText:l.selectedText,boundingBox:l.boundingBox,nearbyText:l.nearbyText,cssClasses:l.cssClasses,nearbyElements:l.nearbyElements,computedStyles:l.computedStyles,fullPath:l.fullPath,accessibility:l.accessibility,isFixed:l.isFixed};return t.value=[...t.value,b],L(a.value,t.value),n.value=null,b}function E(l){const m=t.value.find(b=>b.id===l);return m?(t.value=t.value.filter(b=>b.id!==l),L(a.value,t.value),m):null}function g(l,m){const b=t.value.findIndex(_=>_.id===l);if(b===-1)return null;const C={...t.value[b],comment:m};return t.value=[...t.value.slice(0,b),C,...t.value.slice(b+1)],L(a.value,t.value),o.value=null,C}function $(){t.value=[],G(a.value)}function c(l){n.value=l}function k(l){o.value=l}function x(l){return t.value.find(m=>m.id===l)}function h(l){return t.value.findIndex(m=>m.id===l)}const y=e.computed(()=>t.value.length),p=e.computed(()=>t.value.length===0);return{annotations:e.readonly(t),pendingAnnotation:e.readonly(n),editingAnnotationId:e.readonly(o),count:y,isEmpty:p,initialize:i,switchPath:r,add:f,remove:E,update:g,clear:$,setPending:c,setEditing:k,getById:x,getIndex:h}}function Z(){return M||(M=Fe()),M}function je(){M=null}function J(t,n=3){const o=[];let a=t,i=0;for(;a&&a!==document.body&&i<n;){let r=a.tagName.toLowerCase();if(a.id)r+=`#${a.id}`;else if(a.classList.length>0){const f=Array.from(a.classList).find(E=>!E.match(/^_/)&&!E.match(/[A-Za-z]+_[a-z0-9]{5,}/));f&&(r+=`.${f}`)}o.unshift(r),a=a.parentElement,i++}return o.join(" > ")}function X(t){const n=[];let o=t;for(;o&&o!==document.documentElement;){let a=o.tagName.toLowerCase();if(o.id)a+=`#${o.id}`;else{const i=o.parentElement;if(i){const r=Array.from(i.children).filter(f=>f.tagName===o.tagName);if(r.length>1){const f=r.indexOf(o)+1;a+=`:nth-of-type(${f})`}}}n.unshift(a),o=o.parentElement}return n.join(" > ")}function j(t){var a,i,r,f,E,g,$;const n=J(t),o=t.tagName.toLowerCase();if(t instanceof SVGElement||t.closest("svg")){const c=t.closest("svg"),k=(a=c==null?void 0:c.querySelector("title"))==null?void 0:a.textContent,x=c==null?void 0:c.getAttribute("aria-label");return{name:k||x||"SVG graphic",path:n}}if(o==="button"||t.getAttribute("role")==="button")return{name:`Button: "${((i=t.textContent)==null?void 0:i.trim().slice(0,30))||t.getAttribute("aria-label")||"Button"}"`,path:n};if(o==="a")return{name:`Link: "${((r=t.textContent)==null?void 0:r.trim().slice(0,30))||t.getAttribute("aria-label")||"Link"}"`,path:n};if(o==="input"||o==="textarea"||o==="select"){const c=t.type||o,k=t.getAttribute("aria-label")||t.getAttribute("placeholder")||((E=(f=document.querySelector(`label[for="${t.id}"]`))==null?void 0:f.textContent)==null?void 0:E.trim());return{name:k?`${c}: "${k}"`:`${c} field`,path:n}}if(/^h[1-6]$/.test(o)){const c=(g=t.textContent)==null?void 0:g.trim().slice(0,40);return{name:c?`${o}: "${c}"`:o,path:n}}if(o==="p"){const c=($=t.textContent)==null?void 0:$.trim();return c&&c.length>0?{name:`Paragraph: "${c.slice(0,40)+(c.length>40?"...":"")}"`,path:n}:{name:"Paragraph",path:n}}if(o==="img"){const c=t.alt;return{name:c?`Image: "${c}"`:"Image",path:n}}if(o==="li")return{name:"List item",path:n};if(t.classList.length>0){const c=Array.from(t.classList).filter(k=>!(k.match(/^_[a-zA-Z0-9]+$/)||k.match(/[A-Za-z]+_[a-z0-9]{5,}$/)));if(c.length>0){const k=c.slice(0,3).join(".");return{name:`${o}.${k}`,path:n}}}if(["nav","header","footer","main","section","article"].includes(o)){const c=t.getAttribute("aria-label");if(c)return{name:`${o}: "${c}"`,path:n}}return{name:o,path:n}}function He(t){var a;const n=t.tagName.toLowerCase();if(t instanceof SVGElement||t.closest("svg"))return"icon";if(n==="button"||t.getAttribute("role")==="button")return"button";const o=((a=t.className)==null?void 0:a.toString())||"";return o.includes("spinner")||o.includes("loader")||o.includes("loading")?"spinner":n}function Q(t){var r,f,E;const n=[],o=t.previousElementSibling;if(o){const g=(r=o.textContent)==null?void 0:r.trim();g&&g.length<100&&n.push(`[prev]: ${g.slice(0,50)}`)}const a=(f=t.textContent)==null?void 0:f.trim();a&&a.length<200&&n.push(a.slice(0,80));const i=t.nextElementSibling;if(i){const g=(E=i.textContent)==null?void 0:E.trim();g&&g.length<100&&n.push(`[next]: ${g.slice(0,50)}`)}return n.join(" | ")}function ee(t){const n=[],o=t.parentElement;o&&o!==document.body&&n.push(`parent: ${o.tagName.toLowerCase()}`);const a=t.previousElementSibling;a&&n.push(`prev: ${a.tagName.toLowerCase()}`);const i=t.nextElementSibling;i&&n.push(`next: ${i.tagName.toLowerCase()}`);const r=t.children.length;return r>0&&n.push(`children: ${r}`),n.join(", ")}function te(t){return!t.classList||t.classList.length===0?"":Array.from(t.classList).filter(n=>!(n.match(/^_[a-zA-Z0-9]+$/)||n.match(/[A-Za-z]+_[a-z0-9]{5,}$/))).join(" ")}function ne(t){const n=window.getComputedStyle(t),o=t.tagName.toLowerCase(),a=[];return a.push(`display: ${n.display}`),a.push(`position: ${n.position}`),["p","span","h1","h2","h3","h4","h5","h6","a","button"].includes(o)&&(a.push(`font-size: ${n.fontSize}`),a.push(`font-weight: ${n.fontWeight}`),a.push(`color: ${n.color}`),a.push(`line-height: ${n.lineHeight}`)),["div","section","article","main","nav","header","footer"].includes(o)&&(a.push(`width: ${n.width}`),a.push(`height: ${n.height}`),a.push(`padding: ${n.padding}`),a.push(`margin: ${n.margin}`),(n.display==="flex"||n.display==="inline-flex")&&(a.push(`flex-direction: ${n.flexDirection}`),a.push(`justify-content: ${n.justifyContent}`),a.push(`align-items: ${n.alignItems}`),a.push(`gap: ${n.gap}`)),(n.display==="grid"||n.display==="inline-grid")&&(a.push(`grid-template-columns: ${n.gridTemplateColumns}`),a.push(`grid-template-rows: ${n.gridTemplateRows}`),a.push(`gap: ${n.gap}`))),n.backgroundColor!=="rgba(0, 0, 0, 0)"&&a.push(`background-color: ${n.backgroundColor}`),n.borderWidth!=="0px"&&a.push(`border: ${n.border}`),n.borderRadius!=="0px"&&a.push(`border-radius: ${n.borderRadius}`),a.join("; ")}function We(t){const n=window.getComputedStyle(t);return["display","position","top","right","bottom","left","width","height","min-width","min-height","max-width","max-height","padding","margin","border","border-radius","background","background-color","color","font-family","font-size","font-weight","line-height","text-align","flex-direction","justify-content","align-items","gap","grid-template-columns","grid-template-rows","overflow","z-index","opacity","transform","transition","animation"].map(a=>{const i=n.getPropertyValue(a);return i&&i!=="none"&&i!=="normal"&&i!=="auto"?`${a}: ${i}`:null}).filter(Boolean).join("; ")}function oe(t){const n=[],o=t.getAttribute("role");o&&n.push(`role="${o}"`);const a=Array.from(t.attributes).filter(f=>f.name.startsWith("aria-")).map(f=>`${f.name}="${f.value}"`).join(" ");a&&n.push(a);const i=t.getAttribute("tabindex");return i!==null&&n.push(`tabindex="${i}"`),["a","button","input","textarea","select"].includes(t.tagName.toLowerCase())&&n.push("focusable"),n.join(" ")}function ae(t){let n=t;for(;n&&n!==document.body;){const o=window.getComputedStyle(n).position;if(o==="fixed"||o==="sticky")return!0;n=n.parentElement}return!1}function ie(t){const n=e.ref(!1),o=e.ref(null),a=e.ref(null),i=e.ref(null),r="[data-agentation-ignore]";function f(h){return!!(h.closest(r)||h===document.body||h===document.documentElement)}function E(h){var p,l;const y=h.target;if(f(y)){o.value=null,a.value=null,i.value=null,(p=t.onHoverChange)==null||p.call(t,null);return}if(y!==o.value){o.value=y;const m=y.getBoundingClientRect();a.value=m;const{name:b,path:C}=j(y),_={element:y,name:b,path:C,rect:m};i.value=_,(l=t.onHoverChange)==null||l.call(t,_)}}function g(h){h.preventDefault(),h.stopPropagation();const y=h.target;if(f(y))return;const{name:p,path:l}=j(y),m=y.getBoundingClientRect(),b=window.innerWidth,C=window.scrollY,_=ae(y),N={x:(m.left+m.width/2)/b*100,y:_?m.top+m.height/2:m.top+m.height/2+C,element:p,elementPath:l,boundingBox:{x:m.left,y:m.top,width:m.width,height:m.height},nearbyText:Q(y),nearbyElements:ee(y),cssClasses:te(y),computedStyles:ne(y),fullPath:X(y),accessibility:oe(y),isFixed:_};k(),t.onSelect(N,y)}function $(h){h.key==="Escape"&&k()}function c(){n.value||(n.value=!0,document.addEventListener("mousemove",E,{capture:!0}),document.addEventListener("click",g,{capture:!0}),document.addEventListener("keydown",$),document.body.style.cursor="crosshair")}function k(){var h;n.value&&(n.value=!1,o.value=null,a.value=null,i.value=null,document.removeEventListener("mousemove",E,{capture:!0}),document.removeEventListener("click",g,{capture:!0}),document.removeEventListener("keydown",$),document.body.style.cursor="",(h=t.onHoverChange)==null||h.call(t,null))}function x(){n.value?k():c()}return e.onUnmounted(()=>{n.value&&k()}),{isActive:e.readonly(n),hoveredElement:e.readonly(o),highlightBox:e.readonly(a),elementInfo:e.readonly(i),start:c,stop:k,toggle:x}}const Re="agentation-animation-freeze",H="--agentation-animation-state";function le(){const t=e.ref(!1);let n=null;function o(){t.value||(document.documentElement.style.setProperty(H,"paused"),n||(n=document.createElement("style"),n.id=Re,n.textContent=`
        *,
        *::before,
        *::after {
          animation-play-state: var(${H}, running) !important;
        }
      `,document.head.appendChild(n)),document.querySelectorAll("video").forEach(r=>{r.paused||(r.dataset.agentationWasPlaying="true",r.pause())}),t.value=!0)}function a(){t.value&&(document.documentElement.style.removeProperty(H),n&&n.parentNode&&(n.parentNode.removeChild(n),n=null),document.querySelectorAll("video[data-agentation-was-playing]").forEach(r=>{delete r.dataset.agentationWasPlaying,r.play().catch(()=>{})}),t.value=!1)}function i(){t.value?a():o()}return e.onUnmounted(()=>{t.value&&a()}),{isPaused:e.readonly(t),pause:o,resume:a,toggle:i}}function re(){const t=e.ref(!1);function n(){const i=K();i?t.value=i==="dark":typeof window<"u"&&(t.value=window.matchMedia("(prefers-color-scheme: dark)").matches)}function o(){t.value=!t.value,F(t.value?"dark":"light")}function a(i){t.value=i,F(i?"dark":"light")}return e.onMounted(()=>{n()}),{isDark:e.readonly(t),toggle:o,set:a,initialize:n}}function se(t,n="standard"){if(t.length===0)return"No annotations to display.";const o=["# Page Annotations","",`Generated: ${new Date().toISOString()}`,`URL: ${typeof window<"u"?window.location.href:"N/A"}`,"","---",""];return t.forEach((a,i)=>{if(o.push(`## ${i+1}. ${a.element}`),o.push(""),o.push(`**Comment:** ${a.comment}`),o.push(""),o.push(`**Selector:** \`${a.elementPath}\``),o.push(""),o.push(`**Position:** x=${a.x.toFixed(1)}%, y=${a.y.toFixed(0)}px`),o.push(""),a.selectedText&&(o.push(`**Selected Text:** "${a.selectedText}"`),o.push("")),a.boundingBox){const r=a.boundingBox;o.push(`**Bounding Box:** x=${r.x.toFixed(0)}, y=${r.y.toFixed(0)}, w=${r.width.toFixed(0)}, h=${r.height.toFixed(0)}`),o.push("")}n!=="compact"&&(a.nearbyText&&(o.push(`**Nearby Text:** ${a.nearbyText}`),o.push("")),a.cssClasses&&(o.push(`**CSS Classes:** \`${a.cssClasses}\``),o.push(""))),(n==="detailed"||n==="forensic")&&(a.nearbyElements&&(o.push(`**Nearby Elements:** ${a.nearbyElements}`),o.push("")),a.accessibility&&(o.push(`**Accessibility:** ${a.accessibility}`),o.push(""))),n==="forensic"&&(a.fullPath&&(o.push(`**Full Path:** \`${a.fullPath}\``),o.push("")),a.computedStyles&&(o.push("**Computed Styles:**"),o.push("```css"),o.push(a.computedStyles),o.push("```"),o.push(""))),o.push("---"),o.push("")}),o.join(`
`)}function Oe(t){return[`[${t.element}]`,t.comment,`(${t.elementPath})`].join(" ")}const Ue=["aria-pressed"],Ye=["aria-pressed","title"],qe={key:0,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},Ge={key:1,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},Ke=["disabled","title"],Ze={key:0,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Je={key:1,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xe={key:2,class:"agentation-toolbar__badge"},Qe=["disabled"],et=["title"],tt={key:0,class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},nt={key:1,class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ot={style:{position:"absolute",inset:"0","z-index":"99998","pointer-events":"none"},"data-agentation-ignore":""},W="#3b82f6",at=e.defineComponent({__name:"Agentation",emits:["annotation-add","annotation-delete","annotation-update","annotations-clear","copy"],setup(t,{emit:n}){const o=n,{annotations:a,pendingAnnotation:i,editingAnnotationId:r,count:f,isEmpty:E,initialize:g,switchPath:$,add:c,remove:k,update:x,clear:h,setPending:y,setEditing:p,getById:l}=Z(),{isPaused:m,toggle:b}=le(),{isDark:C,toggle:_}=re(),N=e.ref(!1),V=e.ref(null),z=e.ref(!1),it=e.computed(()=>{if(i.value)return i.value.x/100*(typeof window<"u"?window.innerWidth:0);if(r.value){const d=l(r.value);return d?d.x/100*(typeof window<"u"?window.innerWidth:0):0}return 0}),lt=e.computed(()=>{if(i.value){const d=typeof window<"u"?window.scrollY:0;return i.value.isFixed?i.value.y:i.value.y-d}else if(r.value){const d=l(r.value);if(!d)return 0;const s=typeof window<"u"?window.scrollY:0;return d.isFixed?d.y:d.y-s}return 0}),B=e.computed(()=>{if(i.value)return{element:i.value.element,selectedText:i.value.selectedText,computedStyles:i.value.computedStyles,initialValue:"",submitLabel:"Add"};if(r.value){const d=l(r.value);if(d)return{element:d.element,selectedText:d.selectedText,computedStyles:d.computedStyles,initialValue:d.comment,submitLabel:"Update"}}return null}),ce=e.computed(()=>{if(!S.value)return{vertical:"top",horizontal:"left"};const d=32,s=150,w=8,A=typeof window<"u"?window.innerWidth:1e3,U=S.value.top<d+w,mt=S.value.left+s>A-w,ft=S.value.left+S.value.width<s+w;return{vertical:U?"bottom":"top",horizontal:mt&&!ft?"right":"left"}}),{isActive:R,highlightBox:S,elementInfo:de,toggle:ue}=ie({onSelect:d=>{y(d),p(null),N.value=!0},onHoverChange:()=>{}}),O=e.ref(P());let v=null;function rt(){const d=P();d!==O.value&&(O.value=d,$(d))}function me(){rt(),v=requestAnimationFrame(me)}e.onMounted(()=>{if(typeof window<"u"){const d=P();O.value=d,g(d),v=requestAnimationFrame(me)}}),e.onUnmounted(()=>{v!==null&&(cancelAnimationFrame(v),v=null)});function st(d){if(i.value){const s=c(i.value,d);N.value=!1,o("annotation-add",s)}else if(r.value){const s=x(r.value,d);N.value=!1,p(null),s&&o("annotation-update",s)}}function ct(){N.value=!1,y(null),p(null)}function fe(d){const s=k(d.id);s&&o("annotation-delete",s)}function pe(d){y(null),p(d.id),N.value=!0}function dt(){a.value.length!==0&&confirm("Clear all annotations?")&&(h(),o("annotations-clear"))}async function ut(){const d=se([...a.value]);try{await navigator.clipboard.writeText(d),z.value=!0,setTimeout(()=>{z.value=!1},2e3)}catch{console.log(d)}o("copy",d)}function ge(d){console.log("Marker clicked:",d)}return(d,s)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{class:e.normalizeClass(["agentation-toolbar",e.unref(C)?"agentation-toolbar--dark":""]),"data-agentation-ignore":"",role:"toolbar","aria-label":"Agentation annotation tools"},[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",e.unref(R)&&"agentation-toolbar__button--active"]),"aria-pressed":e.unref(R),title:"Select element to annotate",onClick:s[0]||(s[0]=(...w)=>e.unref(ue)&&e.unref(ue)(...w))},[...s[5]||(s[5]=[e.createElementVNode("svg",{class:"agentation-toolbar__icon",fill:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{d:"M4 4l7.07 17 2.51-7.39L21 11.07 4 4zm9.33 8.33l-1.62 4.79L6.27 6.27l10.85 5.06-3.79 1z"})],-1)])],10,Ue),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",e.unref(m)&&"agentation-toolbar__button--paused"]),"aria-pressed":e.unref(m),title:e.unref(m)?"Resume animations":"Pause animations",onClick:s[1]||(s[1]=(...w)=>e.unref(b)&&e.unref(b)(...w))},[e.unref(m)?(e.openBlock(),e.createElementBlock("svg",qe,[...s[6]||(s[6]=[e.createElementVNode("path",{d:"M8 5v14l11-7z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",Ge,[...s[7]||(s[7]=[e.createElementVNode("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"},null,-1)])]))],10,Ye),s[13]||(s[13]=e.createElementVNode("div",{class:"agentation-toolbar__divider"},null,-1)),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["agentation-toolbar__button",z.value&&"agentation-toolbar__button--success"]),disabled:e.unref(E),title:`Copy ${e.unref(f)} annotation(s) as markdown`,onClick:ut},[z.value?(e.openBlock(),e.createElementBlock("svg",Ze,[...s[8]||(s[8]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",Je,[...s[9]||(s[9]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])])),e.unref(f)>0?(e.openBlock(),e.createElementBlock("span",Xe,e.toDisplayString(e.unref(f)),1)):e.createCommentVNode("",!0)],10,Ke),e.createElementVNode("button",{type:"button",class:"agentation-toolbar__button",disabled:e.unref(E),title:"Clear all annotations",onClick:dt},[...s[10]||(s[10]=[e.createElementVNode("svg",{class:"agentation-toolbar__icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Qe),s[14]||(s[14]=e.createElementVNode("div",{class:"agentation-toolbar__divider"},null,-1)),e.createElementVNode("button",{type:"button",class:"agentation-toolbar__button",title:e.unref(C)?"Switch to light mode":"Switch to dark mode",onClick:s[2]||(s[2]=(...w)=>e.unref(_)&&e.unref(_)(...w))},[e.unref(C)?(e.openBlock(),e.createElementBlock("svg",tt,[...s[11]||(s[11]=[e.createElementVNode("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",nt,[...s[12]||(s[12]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])]))],8,et)],2),e.unref(R)&&e.unref(S)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"agentation-highlight",style:e.normalizeStyle({left:`${e.unref(S).left}px`,top:`${e.unref(S).top}px`,width:`${e.unref(S).width}px`,height:`${e.unref(S).height}px`}),"data-agentation-ignore":""},[e.unref(de)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["agentation-highlight__tooltip",`agentation-highlight__tooltip--${ce.value.vertical}-${ce.value.horizontal}`])},e.toDisplayString(e.unref(de).name),3)):e.createCommentVNode("",!0)],4)):e.createCommentVNode("",!0),e.createElementVNode("div",ot,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a).filter(w=>!w.isFixed),(w,A)=>(e.openBlock(),e.createBlock(I,{key:w.id,annotation:w,index:A,dark:e.unref(C),"accent-color":W,"is-hovered":V.value===w.id,style:{"pointer-events":"auto"},onClick:ge,onEdit:pe,onDelete:fe,onMouseenter:U=>V.value=w.id,onMouseleave:s[3]||(s[3]=U=>V.value=null)},null,8,["annotation","index","dark","is-hovered","onMouseenter"]))),128))]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a).filter(w=>w.isFixed),w=>(e.openBlock(),e.createBlock(I,{key:w.id,annotation:w,index:e.unref(a).findIndex(A=>A.id===w.id),dark:e.unref(C),"accent-color":W,"is-hovered":V.value===w.id,onClick:ge,onEdit:pe,onDelete:fe,onMouseenter:A=>V.value=w.id,onMouseleave:s[4]||(s[4]=A=>V.value=null)},null,8,["annotation","index","dark","is-hovered","onMouseenter"]))),128)),N.value&&B.value?(e.openBlock(),e.createBlock(Y,{key:1,element:B.value.element,x:it.value,y:lt.value,"selected-text":B.value.selectedText,"computed-styles":B.value.computedStyles,"initial-value":B.value.initialValue,"submit-label":B.value.submitLabel,dark:e.unref(C),"accent-color":W,onSubmit:st,onCancel:ct},null,8,["element","x","y","selected-text","computed-styles","initial-value","submit-label","dark"])):e.createCommentVNode("",!0)]))}});u.Agentation=at,u.AnnotationMarker=I,u.AnnotationPopup=Y,u.clearAnnotations=G,u.generateAnnotationSummary=Oe,u.generateMarkdown=se,u.getAccessibilityInfo=oe,u.getCurrentRoutePath=P,u.getDetailedComputedStyles=ne,u.getElementClasses=te,u.getElementPath=J,u.getForensicComputedStyles=We,u.getFullElementPath=X,u.getNearbyElements=ee,u.getNearbyText=Q,u.getStorageKey=T,u.identifyAnimationElement=He,u.identifyElement=j,u.isElementFixed=ae,u.loadAnnotations=D,u.loadSettings=Ie,u.loadTheme=K,u.resetAnnotations=je,u.saveAnnotations=L,u.saveSettings=De,u.saveTheme=F,u.useAnimationPause=le,u.useAnnotations=Z,u.useElementSelection=ie,u.useTheme=re,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})}));
